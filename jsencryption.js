/*
	JavaScript Encryption and Decryption 2.0
	http://www.vincentcheung.ca/jsencryption/
	
	The backend is Gibberish AES by Mark Percival (http://github.com/markpercival/gibberish-aes/tree/master)
	
	Copyright 2008 Vincent Cheung
	Dec. 16, 2008
*/
var decryptElementId;function decryptText(a,b,c){decryptElementId=a;if(b==null){b="Hãy nhập mật khẩu:"}if(c!=null&&c){var d=prompt(b,"");decrypt(d)}else{vcPrompt(b,decrypt)}}function decrypt(a){if(a!=""&&a!=null){if(decryptElementId.constructor!=Array){decryptElementId=[decryptElementId]}var b=false;for(var i=0;i<decryptElementId.length;i++){var c=document.getElementById(decryptElementId[i]);var d=c.title;try{var e=GibberishAES.dec(d,a);b=true;c.innerHTML=e;c.title=""}catch(err){}}if(!b){alert("Sai mật khẩu!","test")}}}var overlayElt=null;var winElt=null;var passElt=null;var promptElt=null;function vcPrompt(a){if(overlayElt==null||winElt==null||passElt==null||promptElt==null){vcCreateDialog(a)}promptElt.innerHTML=a!=null?a:"Enter password:";pageSize=getPageSize();winElt.style.marginTop=Math.round(pageSize[3]*0.3)+"px";winElt.style.marginLeft=Math.round((pageSize[2]-400)/2)+"px";isIE6=/msie|MSIE 6/.test(navigator.userAgent);if(isIE6){pageScroll=getPageScroll();overlayElt.style.position="absolute";overlayElt.style.width=pageSize[0]+"px";overlayElt.style.height=pageSize[1]+"px";winElt.style.position="absolute";winElt.style.top=pageScroll[1]+"px";winElt.style.left=pageScroll[0]+"px"}passElt.value="";overlayElt.style.display="block";winElt.style.display="block";passElt.focus();passElt.select()}function vcCreateDialog(){overlayElt=document.createElement("div");overlayElt.setAttribute("id","vcOverlay");var s=overlayElt.style;s.backgroundColor="black";s.MozOpacity=0.1;s.opacity=0.1;s.filter="alpha(opacity=10)";s.position="fixed";s.top=0;s.left=0;s.width="100%";s.height="100%";s.zIndex=254;s.textAlign="left";s.margin=0;s.padding=0;var a=document.getElementsByTagName("body").item(0);a.insertBefore(overlayElt,a.firstChild);winElt=document.createElement("div");winElt.setAttribute("id","vcWin");s=winElt.style;s.position="fixed";s.top=0;s.left=0;s.width="400px";s.zIndex=255;s.border="1px solid black";s.backgroundColor="#fbfcfd";s.textAlign="left";s.margin=0;s.padding=0;a.insertBefore(winElt,a.firstChild);var b=document.createElement("div");b.setAttribute("id","vcInWin");s=b.style;s.border="5px solid #808080";s.padding="15px";s.margin=0;winElt.appendChild(b);promptElt=document.createElement("p");promptElt.setAttribute("id","vcPrompt");s=promptElt.style;s.padding=0;s.margin=0;s.fontFamily="Arial, sans-serif";s.fontSize="14px";s.textAlign="left";s.color="black";b.appendChild(promptElt);passElt=document.createElement("input");passElt.setAttribute("id","vcPass");passElt.type="text";passElt.onkeydown=function(c){if(c==null){c=window.event}if((c.keyCode==10)||(c.keyCode==13)){vcClick(1)}if(c.keyCode==27){vcClick(0)}};s=passElt.style;s.position="relative";s.width="345px";s.padding="5px";s.margin="5px 0 10px 0";s.fontFamily="monospace";s.fontSize="14px";s.textAlign="left";s.color="black";s.border="2px solid #808080";s.backgroundColor="white";b.appendChild(passElt);var c=document.createElement("div");c.style.textAlign="right";c.style.fontFamily="Arial, sans-serif";c.style.fontSize="14px";b.appendChild(c);var d=document.createElement("input");d.type="button";d.value="Duyệt";d.onclick=function(){vcClick(1)};d.style.margin="0 0 0 0.5em";d.style.padding="5px";d.style.color="black";c.appendChild(d);d=document.createElement("input");d.type="button";d.value="Hủy";d.onclick=function(){vcClick(0)};d.style.margin="0 0 0 0.5em";d.style.padding="5px";d.style.color="black";c.appendChild(d)}function vcClick(a){overlayElt.style.display="none";winElt.style.display="none";if(a){decrypt(passElt.value)}else{}}function getPageScroll(){var a;if(self.pageYOffset){a=self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){a=document.documentElement.scrollTop}else{if(document.body){a=document.body.scrollTop}}}var b;if(self.pageXOffset){b=self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollLeft){b=document.documentElement.scrollLeft}else{if(document.body){b=document.body.scrollLeft}}}arrayPageScroll=new Array(b,a);return arrayPageScroll}function getPageSize(){var a,b;if(window.innerHeight&&window.scrollMaxY){a=document.body.scrollWidth;b=window.innerHeight+window.scrollMaxY}else{if(document.body.scrollHeight>document.body.offsetHeight){a=document.body.scrollWidth;b=document.body.scrollHeight}else{a=document.body.offsetWidth;b=document.body.offsetHeight}}var c,d;if(self.innerHeight){c=self.innerWidth;d=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){c=document.documentElement.clientWidth;d=document.documentElement.clientHeight}else{if(document.body){c=document.body.clientWidth;d=document.body.clientHeight}}}if(b<d){pageHeight=d}else{pageHeight=b}if(a<c){pageWidth=c}else{pageWidth=a}arrayPageSize=new Array(pageWidth,pageHeight,c,d);return arrayPageSize}var GibberishAES={Nr:14,Nb:4,Nk:8,Decrypt:false,enc_utf8:function(s){try{return unescape(encodeURIComponent(s))}catch(e){throw "Error on UTF-8 encode"}},dec_utf8:function(s){try{return decodeURIComponent(escape(s))}catch(e){throw ("Bad Key")}},padBlock:function(a){var b=[];if(a.length<16){var c=16-a.length;var b=[c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c]}for(var i=0;i<a.length;i++){b[i]=a[i]}return b},block2s:function(a,b){if(a==undefined){throw ("Decryption error: Maybe bad cipher")}var c="";if(b){var d=a[15];if(d>16){throw ("Decryption error: Maybe bad key")}if(d==16){return ""}for(var i=0;i<16-d;i++){c+=String.fromCharCode(a[i])}}else{for(i=0;i<16;i++){c+=String.fromCharCode(a[i])}}return c},a2h:function(a){var b="";for(var i=0;i<a.length;i++){b+=(a[i]<16?"0":"")+a[i].toString(16)}return b},h2a:function(s){var a=[];s.replace(/(..)/g,function(b){a.push(parseInt(b,16))});return a},s2a:function(a){a=this.enc_utf8(a);var b=[];for(var i=0;i<a.length;i++){b[i]=a.charCodeAt(i)}return b},size:function(a){switch(a){case 128:this.Nr=10;this.Nk=4;break;case 192:this.Nr=12;this.Nk=6;break;case 256:this.Nr=14;this.Nk=8;break;default:throw ("Invalid Key Size Specified:"+a)}},randArr:function(a){var b=[];for(var i=0;i<a;i++){b=b.concat(Math.floor(Math.random()*256))}return b},openSSLKey:function(a,b){var c=this.Nr>=12?3:2;var d=[];var e=[];var f=[];var g=[];data00=a.concat(b);f[0]=GibberishAES.Hash.MD5(data00);g=f[0];for(var i=1;i<c;i++){f[i]=GibberishAES.Hash.MD5(f[i-1].concat(data00));g=g.concat(f[i])}d=g.slice(0,4*this.Nk);e=g.slice(4*this.Nk,4*this.Nk+16);return {key:d,iv:e}},rawEncrypt:function(a,b,c){b=this.expandKey(b);var d=Math.ceil(a.length/16);var e=[];for(var i=0;i<d;i++){e[i]=this.padBlock(a.slice(i*16,i*16+16))}if(a.length%16===0){e.push([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]);d++}var f=[];for(var i=0;i<e.length;i++){e[i]=(i===0)?this.xorBlocks(e[i],c):this.xorBlocks(e[i],f[i-1]);f[i]=this.encryptBlock(e[i],b)}return f},rawDecrypt:function(a,b,c){b=this.expandKey(b);var d=a.length/16;var e=[];for(var i=0;i<d;i++){e.push(a.slice(i*16,(i+1)*16))}var f=[];for(var i=e.length-1;i>=0;i--){f[i]=this.decryptBlock(e[i],b);f[i]=(i===0)?this.xorBlocks(f[i],c):this.xorBlocks(f[i],e[i-1])}var g="";for(var i=0;i<d-1;i++){g+=this.block2s(f[i])}g+=this.block2s(f[i],true);return this.dec_utf8(g)},encryptBlock:function(a,b){this.Decrypt=false;var c=this.addRoundKey(a,b,0);for(var d=1;d<(this.Nr+1);d++){c=this.subBytes(c);c=this.shiftRows(c);if(d<this.Nr){c=this.mixColumns(c)}c=this.addRoundKey(c,b,d)}return c},decryptBlock:function(a,b){this.Decrypt=true;var c=this.addRoundKey(a,b,this.Nr);for(var d=this.Nr-1;d>-1;d--){c=this.shiftRows(c);c=this.subBytes(c);c=this.addRoundKey(c,b,d);if(d>0){c=this.mixColumns(c)}}return c},subBytes:function(a){var S=this.Decrypt?this.SBoxInv:this.SBox;var b=[];for(var i=0;i<16;i++){b[i]=S[a[i]]}return b},shiftRows:function(a){var b=[];var c=this.Decrypt?[0,13,10,7,4,1,14,11,8,5,2,15,12,9,6,3]:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11];for(var i=0;i<16;i++){b[i]=a[c[i]]}return b},mixColumns:function(a){var t=[];if(!this.Decrypt){for(var c=0;c<4;c++){t[c*4]=this.G2X[a[c*4]]^this.G3X[a[1+c*4]]^a[2+c*4]^a[3+c*4];t[1+c*4]=a[c*4]^this.G2X[a[1+c*4]]^this.G3X[a[2+c*4]]^a[3+c*4];t[2+c*4]=a[c*4]^a[1+c*4]^this.G2X[a[2+c*4]]^this.G3X[a[3+c*4]];t[3+c*4]=this.G3X[a[c*4]]^a[1+c*4]^a[2+c*4]^this.G2X[a[3+c*4]]}}else{for(var c=0;c<4;c++){t[c*4]=this.GEX[a[c*4]]^this.GBX[a[1+c*4]]^this.GDX[a[2+c*4]]^this.G9X[a[3+c*4]];t[1+c*4]=this.G9X[a[c*4]]^this.GEX[a[1+c*4]]^this.GBX[a[2+c*4]]^this.GDX[a[3+c*4]];t[2+c*4]=this.GDX[a[c*4]]^this.G9X[a[1+c*4]]^this.GEX[a[2+c*4]]^this.GBX[a[3+c*4]];t[3+c*4]=this.GBX[a[c*4]]^this.GDX[a[1+c*4]]^this.G9X[a[2+c*4]]^this.GEX[a[3+c*4]]}}return t},addRoundKey:function(a,b,c){var d=[];for(var i=0;i<16;i++){d[i]=a[i]^b[c][i]}return d},xorBlocks:function(a,b){var c=[];for(var i=0;i<16;i++){c[i]=a[i]^b[i]}return c},expandKey:function(a){var b=this.Nb;var c=this.Nr;var d=this.Nk;var w=[];var e=[];for(var i=0;i<d;i++){var r=[a[4*i],a[4*i+1],a[4*i+2],a[4*i+3]];w[i]=r}for(var i=d;i<(4*(c+1));i++){w[i]=[];for(var t=0;t<4;t++){e[t]=w[i-1][t]}if(i%d===0){e=this.subWord(this.rotWord(e));e[0]^=this.Rcon[i/d-1]}else{if(d>6&&i%d==4){e=this.subWord(e)}}for(var t=0;t<4;t++){w[i][t]=w[i-d][t]^e[t]}}var f=[];for(var i=0;i<(c+1);i++){f[i]=[];for(var j=0;j<4;j++){f[i].push(w[i*4+j][0],w[i*4+j][1],w[i*4+j][2],w[i*4+j][3])}}return f},subWord:function(w){for(var i=0;i<4;i++){w[i]=this.SBox[w[i]]}return w},rotWord:function(w){var a=w[0];for(var i=0;i<4;i++){w[i]=w[i+1]}w[3]=a;return w},enc:function(a,b){var c=this.randArr(8);var d=this.openSSLKey(this.s2a(b),c);var e=d.key;var f=d.iv;a=this.s2a(a);var g=this.rawEncrypt(a,e,f);var h=[[83,97,108,116,101,100,95,95].concat(c)];g=h.concat(g);return this.Base64.encode(g)},dec:function(a,b){var c=this.Base64.decode(a);var d=c.slice(8,16);var e=this.openSSLKey(this.s2a(b),d);var f=e.key;var g=e.iv;var c=c.slice(16,c.length);a=this.rawDecrypt(c,f,g);return a}};GibberishAES.Hash={MD5:function(a){function RotateLeft(b,c){return (b<<c)|(b>>>(32-c))}function AddUnsigned(b,c){var d,e,f,g,h;f=(b&2147483648);g=(c&2147483648);d=(b&1073741824);e=(c&1073741824);h=(b&1073741823)+(c&1073741823);if(d&e){return (h^2147483648^f^g)}if(d|e){if(h&1073741824){return (h^3221225472^f^g)}else{return (h^1073741824^f^g)}}else{return (h^f^g)}}function F(x,y,z){return (x&y)|((~x)&z)}function G(x,y,z){return (x&z)|(y&(~z))}function H(x,y,z){return (x^y^z)}function I(x,y,z){return (y^(x|(~z)))}function FF(b,c,d,e,x,s,f){b=AddUnsigned(b,AddUnsigned(AddUnsigned(F(c,d,e),x),f));return AddUnsigned(RotateLeft(b,s),c)}function GG(b,c,d,e,x,s,f){b=AddUnsigned(b,AddUnsigned(AddUnsigned(G(c,d,e),x),f));return AddUnsigned(RotateLeft(b,s),c)}function HH(b,c,d,e,x,s,f){b=AddUnsigned(b,AddUnsigned(AddUnsigned(H(c,d,e),x),f));return AddUnsigned(RotateLeft(b,s),c)}function II(b,c,d,e,x,s,f){b=AddUnsigned(b,AddUnsigned(AddUnsigned(I(c,d,e),x),f));return AddUnsigned(RotateLeft(b,s),c)}function ConvertToWordArray(b){var c;var d=b.length;var e=d+8;var f=(e-(e%64))/64;var g=(f+1)*16;var h=Array(g-1);var i=0;var j=0;while(j<d){c=(j-(j%4))/4;i=(j%4)*8;h[c]=(h[c]|(b[j]<<i));j++}c=(j-(j%4))/4;i=(j%4)*8;h[c]=h[c]|(128<<i);h[g-2]=d<<3;h[g-1]=d>>>29;return h}function WordToHex(b){var c="",d="",e,f;var g=[];for(f=0;f<=3;f++){e=(b>>>(f*8))&255;g=g.concat(e)}return g}function Utf8Encode(b){b=b.replace(/\r\n/g,"\n");var c="";for(var n=0;n<b.length;n++){var d=b.charCodeAt(n);if(d<128){c+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){c+=String.fromCharCode((d>>6)|192);c+=String.fromCharCode((d&63)|128)}else{c+=String.fromCharCode((d>>12)|224);c+=String.fromCharCode(((d>>6)&63)|128);c+=String.fromCharCode((d&63)|128)}}}return c}var x=Array();var k,b,c,d,e,f,g,h,i;var j=7,l=12,m=17,n=22;var o=5,p=9,q=14,r=20;var s=4,t=11,u=16,v=23;var w=6,y=10,z=15,A=21;x=ConvertToWordArray(a);f=1732584193;g=4023233417;h=2562383102;i=271733878;for(k=0;k<x.length;k+=16){b=f;c=g;d=h;e=i;f=FF(f,g,h,i,x[k+0],j,3614090360);i=FF(i,f,g,h,x[k+1],l,3905402710);h=FF(h,i,f,g,x[k+2],m,606105819);g=FF(g,h,i,f,x[k+3],n,3250441966);f=FF(f,g,h,i,x[k+4],j,4118548399);i=FF(i,f,g,h,x[k+5],l,1200080426);h=FF(h,i,f,g,x[k+6],m,2821735955);g=FF(g,h,i,f,x[k+7],n,4249261313);f=FF(f,g,h,i,x[k+8],j,1770035416);i=FF(i,f,g,h,x[k+9],l,2336552879);h=FF(h,i,f,g,x[k+10],m,4294925233);g=FF(g,h,i,f,x[k+11],n,2304563134);f=FF(f,g,h,i,x[k+12],j,1804603682);i=FF(i,f,g,h,x[k+13],l,4254626195);h=FF(h,i,f,g,x[k+14],m,2792965006);g=FF(g,h,i,f,x[k+15],n,1236535329);f=GG(f,g,h,i,x[k+1],o,4129170786);i=GG(i,f,g,h,x[k+6],p,3225465664);h=GG(h,i,f,g,x[k+11],q,643717713);g=GG(g,h,i,f,x[k+0],r,3921069994);f=GG(f,g,h,i,x[k+5],o,3593408605);i=GG(i,f,g,h,x[k+10],p,38016083);h=GG(h,i,f,g,x[k+15],q,3634488961);g=GG(g,h,i,f,x[k+4],r,3889429448);f=GG(f,g,h,i,x[k+9],o,568446438);i=GG(i,f,g,h,x[k+14],p,3275163606);h=GG(h,i,f,g,x[k+3],q,4107603335);g=GG(g,h,i,f,x[k+8],r,1163531501);f=GG(f,g,h,i,x[k+13],o,2850285829);i=GG(i,f,g,h,x[k+2],p,4243563512);h=GG(h,i,f,g,x[k+7],q,1735328473);g=GG(g,h,i,f,x[k+12],r,2368359562);f=HH(f,g,h,i,x[k+5],s,4294588738);i=HH(i,f,g,h,x[k+8],t,2272392833);h=HH(h,i,f,g,x[k+11],u,1839030562);g=HH(g,h,i,f,x[k+14],v,4259657740);f=HH(f,g,h,i,x[k+1],s,2763975236);i=HH(i,f,g,h,x[k+4],t,1272893353);h=HH(h,i,f,g,x[k+7],u,4139469664);g=HH(g,h,i,f,x[k+10],v,3200236656);f=HH(f,g,h,i,x[k+13],s,681279174);i=HH(i,f,g,h,x[k+0],t,3936430074);h=HH(h,i,f,g,x[k+3],u,3572445317);g=HH(g,h,i,f,x[k+6],v,76029189);f=HH(f,g,h,i,x[k+9],s,3654602809);i=HH(i,f,g,h,x[k+12],t,3873151461);h=HH(h,i,f,g,x[k+15],u,530742520);g=HH(g,h,i,f,x[k+2],v,3299628645);f=II(f,g,h,i,x[k+0],w,4096336452);i=II(i,f,g,h,x[k+7],y,1126891415);h=II(h,i,f,g,x[k+14],z,2878612391);g=II(g,h,i,f,x[k+5],A,4237533241);f=II(f,g,h,i,x[k+12],w,1700485571);i=II(i,f,g,h,x[k+3],y,2399980690);h=II(h,i,f,g,x[k+10],z,4293915773);g=II(g,h,i,f,x[k+1],A,2240044497);f=II(f,g,h,i,x[k+8],w,1873313359);i=II(i,f,g,h,x[k+15],y,4264355552);h=II(h,i,f,g,x[k+6],z,2734768916);g=II(g,h,i,f,x[k+13],A,1309151649);f=II(f,g,h,i,x[k+4],w,4149444226);i=II(i,f,g,h,x[k+11],y,3174756917);h=II(h,i,f,g,x[k+2],z,718787259);g=II(g,h,i,f,x[k+9],A,3951481745);f=AddUnsigned(f,b);g=AddUnsigned(g,c);h=AddUnsigned(h,d);i=AddUnsigned(i,e)}var B=WordToHex(f).concat(WordToHex(g),WordToHex(h),WordToHex(i));return B}};GibberishAES.Base64={chars:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],encode:function(b,a){var c=[];var d="";totalChunks=Math.floor(b.length*16/3);for(var i=0;i<b.length*16;i++){c.push(b[Math.floor(i/16)][i%16])}for(var i=0;i<c.length;i=i+3){d+=this.chars[c[i]>>2];d+=this.chars[((c[i]&3)<<4)|(c[i+1]>>4)];if(!(c[i+1]==null)){d+=this.chars[((c[i+1]&15)<<2)|(c[i+2]>>6)]}else{d+="="}if(!(c[i+2]==null)){d+=this.chars[c[i+2]&63]}else{d+="="}}var e=d.slice(0,64)+"\n";for(var i=1;i<(Math.ceil(d.length/64));i++){e+=d.slice(i*64,i*64+64)+(Math.ceil(d.length/64)==i+1?"":"\n")}return e},decode:function(a){a=a.replace(/\s/g,"");var b=[];var c=[];var d=[];for(var i=0;i<a.length;i=i+4){c[0]=this.chars.indexOf(a.charAt(i));c[1]=this.chars.indexOf(a.charAt(i+1));c[2]=this.chars.indexOf(a.charAt(i+2));c[3]=this.chars.indexOf(a.charAt(i+3));d[0]=(c[0]<<2)|(c[1]>>4);d[1]=((c[1]&15)<<4)|(c[2]>>2);d[2]=((c[2]&3)<<6)|c[3];b.push(d[0],d[1],d[2])}b=b.slice(0,b.length-(b.length%16));return b}};if(!Array.indexOf){Array.prototype.indexOf=function(a,b){for(var i=(b||0);i<this.length;i++){if(this[i]==a){return i}}}}
